{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cash Account</title>

<link rel="stylesheet" href="{% static 'css/style.css' %}">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
.balances {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    padding: 0;
    min-height: 100vh;
}

a{
    text-decoration: none;
}
.container {
    max-width: 1200px;
    margin: 40px auto;
    padding: 20px;
}

.page-title {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 30px;
    color: #333;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 25px;
}

.stat-card {
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-radius: 16px;
    padding: 25px;
    border: 1px solid rgba(102, 126, 234, 0.2);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15), 0 8px 30px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    cursor: pointer;
}

.stat-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
    transform: scaleX(0);
    transition: transform 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-8px);
    box-shadow: 0px 12px 30px rgba(102, 126, 234, 0.3);
    border-color: #667eea;
    background: rgba(255, 255, 255, 1);
}

.stat-card:hover::before {
    transform: scaleX(1);
}

.stat-label {
    font-size: 14px;
    text-transform: uppercase;
    font-weight: 600;
    color: #667eea;
    letter-spacing: 0.5px;
}

.stat-value {
    font-size: 40px;
    font-weight: 700;
    margin-top: 10px;
    color: #1e293b;
    transition: color 0.3s ease;
}

.stat-card:hover .stat-value {
    color: #667eea;
}

.positive { color: #10b981; }
.negative { color: #ef4444; }
</style>
</head>

<body>

<!-- ✅ NAVBAR -->
<div class="top-nav">
    <div class="top-nav-container">
        
        <!-- Left Section -->
        <div class="nav-left">
            <div class="logo">
                <h1 class="logo">
                    <span class="f">F</span>
                    <span class="e">e</span>
                    <span class="d">d</span>
                    <span class="i">I</span>
                    <span class="n">n</span>
                    <span class="v">v</span>
                    <span class="e2">e</span>
                    <span class="s">s</span>
                    <span class="t">t</span>
                </h1>
            </div>

            <nav class="main-nav">
                <a href="{% url 'holdings' %}" class="active erbtn">All accounts</a>
                <a href="#" class="erbtn">Personal Advisor Services</a>
            </nav>
        </div>

        <!-- Right Navigation Icons -->
        <div class="nav-right">

            <a href="#" class="nav-item erbtn">
                <svg viewBox="0 0 24 24">
                    <circle cx="10.5" cy="10.5" r="7.5"></circle>
                    <line x1="21" y1="21" x2="15.8" y2="15.8"></line>
                </svg>
                <span>Search</span>
            </a>

            <a href="#" class="nav-item erbtn">
                <svg viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10"></circle>
                    <text x="12" y="16" font-size="12" text-anchor="middle" fill="none" stroke="#000" stroke-width="0.5">?</text>
                </svg>
                <span>Support</span>
            </a>

            <a href="{% url 'messages' %}" class="nav-item erbtn">
                <svg viewBox="0 0 24 24">
                    <rect x="3" y="5" width="18" height="14" rx="2" ry="2"></rect>
                    <polyline points="3,7 12,13 21,7"></polyline>
                </svg>
                <div class="badge"></div>
                <span>Messages</span>
            </a>

            <a href="{% url 'legal_documents' %}" class="nav-item erbtn">
                <svg viewBox="0 0 24 24">
                    <rect x="6" y="4" width="12" height="16" rx="1"></rect>
                    <line x1="6" y1="8" x2="18" y2="8"></line>
                </svg>
                <span>Documents</span>
            </a>

            <a href="{% url 'get_profile' request.user.id %}" class="nav-item erbtn">
                <svg viewBox="0 0 24 24">
                    <circle cx="12" cy="8" r="4"></circle>
                    <path d="M4 20c0-4 4-6 8-6s8 2 8 6"></path>
                </svg>
                <span>Profile</span>
            </a>

            <a href="{% url 'logout' %}" class="logout-btn">Logout</a>
        </div>

    </div>
</div>

<!-- SECONDARY NAV -->
<div class="secondary-nav">
    <div class="secondary-nav-container">
        <nav>
            <a class="erbtn" href="{% url 'dashboard' %}">Dashboard</a>
            <a class="erbtn" href="{% url 'holdings' %}">Holdings</a>
            <a class="erbtn" href="{% url 'balance' %}">Balances</a>
            <a class="erbtn" href="{% url 'activity' %}">Activity</a>
            <a class="erbtn" href="{% url 'performance' %}">Performance</a>
        </nav>
    </div>
</div>


<div class="balances">
<!-- ✅ CASH ACCOUNT SECTION -->
<div class="container">
    <h1 class="page-title">Brokerage Account(Stocks)</h1>

    

        <div class="stats-grid">
    <!-- Brokerage Balance -->
    <a href="{% url 'portfolio' %}">
        <div class="stat-card">
            <div class="stat-label">Brokerage Balance</div>
            <div class="stat-value" id="brokerage-balance">$0.00</div>
        </div>
    </a>

    <a href="{% url 'portfolio' %}">
        <div class="stat-card">
            <div class="stat-label">Cash Total</div>
            <div class="stat-value" id="raw-total">$0.00</div>
        </div>
    </a>
    <!-- Portfolio Total (Invested in stocks) -->
    <a href="{% url 'portfolio' %}">
        <div class="stat-card">
            <div class="stat-label">Portfolio Total (Invested)</div>
            <div class="stat-value" id="portfolio-total">$0.00</div>
        </div>
    </a>

    <!-- Net Portfolio / Cash -->
</div>

        <!-- <a href="{% url 'portfolio' %}">
          <div class="stat-card">
            <div class="stat-label">Cash Account Balance</div>
            <div class="stat-value" >$0.00</div>
        </div>
      </a> -->

    </div>
</div>
</div>
<script>
function formatMoney(num) {
    if (!num && num !== 0) return "$0.00";
    return "$" + parseFloat(num).toLocaleString("en-US", {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
    });
}

function loadCashAccount() {
    fetch('/api/holdings/')
        .then(res => res.json())
        .then(data => {
            // If API returns error
            if (data.error) {
                document.getElementById("raw-total").textContent = data.error;
                document.getElementById("brokerage-balance").textContent = "$0.00";
                document.getElementById("portfolio-total").textContent = "$0.00";
                return;
            }

            // Update UI with API values
            document.getElementById("brokerage-balance").textContent =
                formatMoney(data.brokerage_balance);

            document.getElementById("portfolio-total").textContent =
                formatMoney(data.portfolio_total);

            document.getElementById("raw-total").textContent =
                formatMoney(data.raw_total);
        })
        .catch(err => console.error("API Error:", err));
}

// Initial load
loadCashAccount();

// Optional: refresh every 50 seconds
setInterval(loadCashAccount, 50000);

</script>

<script src="{% static 'js/main.js' %}"></script>

</body>
</html>